/* Copyright 2019 Thomas Baart <thomas@splitkb.com>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
#include QMK_KEYBOARD_H

enum layers { _BASE = 0, _SYMBOLS, _NUMBERS, _ADJUST };

layer_state_t layer_state_set_user(layer_state_t state) {
    return update_tri_layer_state(state, _SYMBOLS, _NUMBERS, _ADJUST);
}

// ALT TAB
bool is_alt_tab_active = false;    // ADD this near the begining of keymap.c
uint16_t alt_tab_timer = 0;        // we will be using them soon.
bool is_osx = true;                // used to toggle operating system

enum custom_keycodes {            // Make sure have the awesome keycode ready
  ALT_TAB = SAFE_RANGE,
  TOGGLE_OS,
  DESK_LT,
  DESK_RT,
  SLEEP,
  LOCK,
};

#define IS_SHIFT (MOD_BIT(KC_LSFT)) | MOD_BIT(kc_RSFT)

// Shortcuts
// Common
#define ___ _______

// Layers
#define NUM_SPC    LT(_NUMBERS, KC_SPC)
#define SYM_BSPC   LT(_SYMBOLS, KC_BSPC)

// Mod
#define CTL_M      MT(MOD_LCTL, KC_M)
#define GUI_COMM   MT(MOD_LGUI, KC_COMM)

#define GUI_TAB    MT(MOD_LGUI, KC_TAB)
#define CTL_ESC    MT(MOD_LCTL, KC_ESC)
#define SFT_GRV    MT(MOD_LSFT, KC_GRV)

#define GUI_EQL    MT(MOD_LGUI, KC_EQL)
#define CTL_QUOTE  MT(MOD_LCTL, KC_QUOTE)
#define SFT_MINS   MT(MOD_LSFT, KC_MINS)

#define CTL_PLUS   LCTL(KC_PLUS)
#define CTL_MINS   LCTL(KC_MINS)

#define GUI_LEFT   LGUI(KC_LEFT)
#define GUI_RIGHT  LGUI(KC_RIGHT)
#define GUI_UP     LGUI(KC_UP)
#define GUI_DOWN   LGUI(KC_DOWN)
#define MON_LEFT   LGUI(LSFT(KC_LEFT))
#define MON_RIGHT  LGUI(LSFT(KC_RIGHT))

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

[_BASE] = LAYOUT(
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      KC_TAB   , KC_Q     , KC_W     , KC_E     , KC_R     , KC_T     ,                                                KC_Y     , KC_U     , KC_I     , KC_O     , KC_P     , KC_EQL   ,
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      KC_ESC   , KC_A     , KC_S     , KC_D     , KC_F     , KC_G     ,                                                KC_H     , KC_J     , KC_K     , KC_L     , KC_SCLN  , KC_QUOTE,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
      KC_GRV   , KC_Z     , KC_X     , KC_C     , KC_V     , KC_B     , KC_RCTL  , KC_LALT  ,    KC_RALT  , KC_RCTL  , KC_N     , CTL_M    , GUI_COMM , KC_DOT   , KC_SLSH  , KC_MINS ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
                                       LOCK     , KC_LSFT  , SYM_BSPC , KC_ENT   , KC_LGUI  ,    ALT_TAB  , KC_RSFT  , NUM_SPC  , KC_RSFT  , KC_MPLY
//                                   *----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*
    ),

[_SYMBOLS] = LAYOUT(
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      ___      , KC_EXLM  , KC_AT    , KC_HASH  , KC_DLR   , KC_PERC  ,                                                KC_CIRC  , KC_AMPR  , KC_ASTR  , KC_LPRN  , KC_RPRN  , KC_PLUS  ,
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      ___      , ___      , KC_MPRV  , KC_PGUP  , KC_MNXT  , ___      ,                                                ___      , KC_LCBR  , KC_RCBR  , KC_LBRC  , KC_RBRC  , KC_PIPE  ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
      ___      , ___      , ___      , KC_PGDN  , ___      , ___      , ___      , ___      ,    ___      , ___      , ___      , ___      , ___      , ___      , ___      , ___      ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
                                       ___      , ___      , ___      , ___      , ___      ,    ___      , ___      , ___      , ___      , ___
//                                   *----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*
    ),

[_NUMBERS] = LAYOUT(
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      ___      , KC_1     , KC_2     , KC_3     , KC_4     , KC_5     ,                                                KC_6     , KC_7     , KC_8     , KC_9     , KC_0     , KC_EQL   ,
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      ___      , ___      , GUI_LEFT , GUI_UP   , GUI_RIGHT, ___      ,                                                KC_LEFT  , KC_DOWN  , KC_UP    , KC_RIGHT , ___      , ___      ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
      ___      , ___      , MON_LEFT , GUI_DOWN , MON_RIGHT, ___      , ___      , ___      ,    ___      , ___      , ___      , DESK_LT  , DESK_RT  , ___      , KC_BSLS  , ___      ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
                                       ___      , ___      , ___      , ___      , ___      ,    ___      , ___      , ___      , ___      , ___
//                                   *----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*
    ),

[_ADJUST] = LAYOUT(
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
     TOGGLE_OS , KC_F1    , KC_F2    , KC_F3    , KC_F4    , KC_F5    ,                                                KC_F6    , KC_F7    , KC_F8    , KC_F9    , KC_F10   , ___      ,
//  *----------*----------*----------*----------*----------*----------*                                              *----------*----------*----------*----------*----------*----------*
      ___      , RGB_TOG  , RGB_SAI  , RGB_HUI  , RGB_VAI  , RGB_MOD  ,                                                ___      , CTL_MINS , CTL_PLUS , KC_F11   , KC_F12   , ___      ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
      ___      , ___      , RGB_SAD  , RGB_HUD  , RGB_VAD  , RGB_RMOD , ___      , ___      ,    ___      , ___      , ___      , ___      , ___      , ___      , ___      , ___      ,
//  *----------*----------*----------*----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*----------*----------*----------*
                                       RESET    , ___      , ___      , ___      , ___      ,    ___      , ___      , ___      , ___      , ___
//                                   *----------*----------*----------*----------*----------*  *----------*----------*----------*----------*----------*
    )
};



// key processing
bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  bool pressed = record->event.pressed;
  if (is_alt_tab_active && pressed) {
    alt_tab_timer = timer_read();
  }

  switch (keycode) {               // This will do most of the grunt work with the keycodes.
    case LOCK: {
      if (pressed) {
          if (is_osx) {
            uint16_t code = LCTL(LGUI(KC_LEFT));
            tap_code16(code);
          } else {
            SEND_STRING(SS_LGUI("x") SS_DELAY(100) "us" SS_TAP(X_ENT));
          }
      }
      break;
    }
    case TOGGLE_OS: {
      if (pressed) {
        is_osx = !is_osx;
      }
      break;
    }
    case DESK_LT: {
      if (pressed) {
        uint16_t code = is_osx ? LCTL(KC_LEFT) : LGUI(LCTL(KC_LEFT));
        tap_code16(code);
      }
      break;
    }
    case DESK_RT: {
     if (pressed) {
        uint16_t code = is_osx ? LCTL(KC_RIGHT) : LGUI(LCTL(KC_RIGHT));
        tap_code16(code);
      }
      break;
    }
    case ALT_TAB: {
      if (pressed) {
        uint16_t alt = is_osx ? KC_LGUI : KC_LALT;
 
        if (!is_alt_tab_active) {
          is_alt_tab_active = true;
          register_code(alt);
          alt_tab_timer = timer_read();
        }
        register_code(KC_TAB);
      } else {
        unregister_code(KC_TAB);
      }
      break;
    }
  }

  return true;
}

void matrix_scan_user(void) {
  if (is_alt_tab_active && timer_elapsed(alt_tab_timer) > 1000) {
    uint16_t alt = is_osx ? KC_LGUI : KC_LALT;
    unregister_code(alt);
    is_alt_tab_active = false;
  }
}

#ifdef OLED_DRIVER_ENABLE
oled_rotation_t oled_init_user(oled_rotation_t rotation) {
	return OLED_ROTATION_180;
}


static void render_right_logo(void) {
    static const char PROGMEM right_logo[] = {
        // 'su', 128x64px
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0xf8, 0xf8, 0xf0, 0xf0, 0xe0, 0x00, 0x80, 0x80, 0xc0, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x82, 0xe1, 0xfd, 0xff, 0xff, 0x7f, 0x3f, 0x0f, 0x83, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0xc0, 0xe0, 0xe0, 0xf3, 0x7f, 0x7f, 0xff, 0xff, 0xff, 0xc7, 0x11, 0x30, 0x30, 0x38, 0xf8, 0xf8, 0x7c, 0x3f, 0x1f, 0x0f, 0x07, 0x07, 0x0f, 0x07, 0x07, 0x07, 0x87, 0xc3, 0xc3, 0x87, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x03, 0x03, 0x81, 0xf1, 0xf8, 0xf0, 0x70, 0x60, 0xe1, 0xe3, 0xe7, 0xe7, 0xe6, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x30, 0x38, 0x38, 0x1c, 0x7e, 0xff, 0xff, 0x07, 0x07, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xe0, 0xf0, 0xf8, 0x7c, 0x3f, 0x8f, 0x47, 0xa3, 0xf0, 0xd8, 0xee, 0xf7, 0x93, 0x09, 0x09, 0x0c, 0x04, 0xfc, 0xfc, 0xfc, 0x78, 0x00, 0x00, 0x00, 0x80, 0x80, 0xc0, 0x60, 0x60, 0xff, 0xff, 0xff, 0xe9, 0xce, 0x0e, 0x0e, 0x06, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0x70, 0x78, 0x3c, 0x1e, 0x0f, 0x07, 0x07, 0x0f, 0xff, 0xfc, 0xfc, 0xfc, 0x23, 0x11, 0xc8, 0x2c, 0xff, 0xff, 0xff, 0xf7, 0x73, 0x38, 0x3f, 0x0f, 0x07, 0x03, 0x02, 0x02, 0x03, 0x03, 0x81, 0xc0, 0xe0, 0xf0, 0xf8, 0xff, 0xff, 0xff, 0xc3, 0xc0, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x0f, 0x1f, 0x9f, 0xdc, 0xf4, 0xfe, 0x7e, 0x7f, 0x37, 0x31, 0x18, 0x18, 0x08, 0x0c, 0x8c, 0xc4, 0x64, 0x30, 0x18, 0x0e, 0x1e, 0x67, 0xc3, 0x81, 0x00, 0x00, 0x00, 0x1f, 0xff, 0xfd, 0x81, 0x01, 0x03, 0x03, 0x07, 0x07, 0x07, 0x4e, 0x4e, 0x5c, 0x7c, 0x78, 0x78, 0xf0, 0xf0, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x0c, 0x0c, 0x0e, 0x07, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x06, 0x06, 0x0e, 0x1f, 0x1f, 0x1f, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    oled_write_raw_P(right_logo, sizeof(right_logo));
}


static void render_status(void) {
    // QMK Logo and version information
    // render_qmk_logo();
    // oled_write_P(PSTR("Kyria rev1.0\n\n"), false);

    // Host Keyboard Layer Status
    switch (get_highest_layer(layer_state)) {
        case _BASE:
            if (is_osx) {
              oled_write_P(PSTR("Base: OSX\n"), false);
            } else {
              oled_write_P(PSTR("Base: Windows\n"), false);
            }
            oled_write_P(PSTR("ENC:  MUTE - PLAY\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("BSP/SYM - SPC/NUM\n"), false);
            oled_write_P(PSTR("CTL ALT - ALT CTL\n"), false);
            oled_write_P(PSTR("ENT GUI - ATB SFT\n"), false);
            break;
        case _SYMBOLS:
            oled_write_P(PSTR("1: Symbols\n"), false);
            oled_write_P(PSTR("2: Media - Brackets\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            break;
        case _NUMBERS:
            oled_write_P(PSTR("1: Numbers\n"), false);
            oled_write_P(PSTR("2: Win Move - Move\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            break;
        case _ADJUST:
            oled_write_P(PSTR("Adjust \n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            oled_write_P(PSTR("\n"), false);
            break;
        default:
            oled_write_P(PSTR("Undefined\n"), false);
    }

    // Host Keyboard LED Status
    uint8_t led_usb_state = host_keyboard_leds();
    oled_write_P(IS_LED_ON(led_usb_state, USB_LED_NUM_LOCK) ? PSTR("NUMLCK ") : PSTR("       "), false);
    oled_write_P(IS_LED_ON(led_usb_state, USB_LED_CAPS_LOCK) ? PSTR("CAPLCK ") : PSTR("       "), false);
    oled_write_P(IS_LED_ON(led_usb_state, USB_LED_SCROLL_LOCK) ? PSTR("SCRLCK ") : PSTR("       "), false);
}

void oled_task_user(void) {
    if (is_keyboard_master()) {
        render_status(); // Renders the current keyboard state (layer, lock, caps, scroll, etc)
    } else {
        render_right_logo();
    }
}
#endif

#ifdef ENCODER_ENABLE
void encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 1) {
        // Volume control
        if (clockwise) {
            tap_code(KC_VOLD);
        } else {
            tap_code(KC_VOLU);
        }
    }
    else if (index == 0) {
        // Page up/Page down
        if (clockwise) {
            tap_code(KC_PGUP);
        } else {
            tap_code(KC_PGDN);
        }
    }
}
#endif
